SELECT W.ID, W.AGE, W.COINS_NEEDED, W.POWER
FROM WANDS W
JOIN WANDS_PROPERTY WP ON W.CODE = WP.CODE
WHERE WP.IS_EVIL = 0
  AND W.COINS_NEEDED = (
      SELECT MIN(W2.COINS_NEEDED)
      FROM WANDS W2
      JOIN WANDS_PROPERTY WP2 ON W2.CODE = WP2.CODE
      WHERE W2.POWER = W.POWER AND WP2.IS_EVIL = 0
  )
ORDER BY W.POWER DESC, W.AGE DESC;
