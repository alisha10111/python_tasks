SELECT HACKER_ID, NAME, SUM(MAX_SCORE) AS TOTAL_SCORE
FROM (
  SELECT HACKER_ID, CHALLENGE_ID, MAX(SCORE) AS MAX_SCORE
  FROM SUBMISSIONS
  GROUP BY HACKER_ID, CHALLENGE_ID
) AS SCORES
JOIN HACKERS USING(HACKER_ID)
GROUP BY HACKER_ID, NAME
HAVING TOTAL_SCORE > 0
ORDER BY TOTAL_SCORE DESC, HACKER_ID;
